(this["webpackJsonposrs-market-watch"]=this["webpackJsonposrs-market-watch"]||[]).push([[0],{106:function(t,e,a){t.exports=a(120)},111:function(t,e,a){},120:function(t,e,a){"use strict";a.r(e);var r=a(0),n=a.n(r),i=a(19),s=a.n(i),c=(a(111),a(5)),l=a(6),o=a(8),h=a(9),d=a(13),u=a(10),p=(a(53),a(2)),m=a(150),g=function(t){function e(t){var a;Object(c.a)(this,e),(a=Object(o.a)(this,Object(h.a)(e).call(this,t))).node=n.a.createRef(),a.margin={top:20,right:60,left:20,bottom:20,xbuffer:20},a.period=7,a.chartWidth=a.props.width-a.margin.left-a.margin.right,a.xScale=p.m().domain(p.e(a.props.data,(function(t){return t.ts}))).range([0,a.chartWidth]);var r=p.i(a.props.data,(function(t){return t.ts})),i=new Date(r);return i.setFullYear(r.getFullYear()-1),a.transform=p.q.scale(a.chartWidth/(a.xScale(r)-a.xScale(i))).translate(-a.xScale(i),0),a.legendFormat=p.f(".3~s"),a.gpFormat=function(t){return"".concat(p.f(".3~s")(t)," gp")},a.volFormat=p.f(".3~s"),a.candleData=a.generateCandlestickData(a.props.data,a.period),a.rsiData=a.generateRSI(a.props.data,14),a.smaData=a.generateSimpleMovingAverage(a.props.data,14),a.candleHeight=.35*a.props.height,a.priceHeight=.25*a.props.height,a.volumeHeight=.1333*a.props.height,a.rsiHeight=.1333*a.props.height,a.stochRsiHeight=.1333*a.props.height,a.green="#60d68a",a.red="#d66061",a.text="#e7e7e7",a.grid="#777777",a.state={currentDate:null},a.zoomed=a.zoomed.bind(Object(d.a)(a)),a.drawChart=a.drawChart.bind(Object(d.a)(a)),a.renderCandleLegend=a.renderCandleLegend.bind(Object(d.a)(a)),a.renderVolumeLegend=a.renderVolumeLegend.bind(Object(d.a)(a)),a.renderPriceLegend=a.renderPriceLegend.bind(Object(d.a)(a)),a.renderChartTitle=a.renderChartTitle.bind(Object(d.a)(a)),a.state={currentDate:null,currentScale:a.transform.rescaleX(a.xScale)},a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidUpdate",value:function(t,e){t!==this.props&&(t.data!==this.props.data&&(this.candleData=this.generateCandlestickData(this.props.data,this.period),this.rsiData=this.generateRSI(this.props.data,14),this.smaData=this.generateSimpleMovingAverage(this.props.data,14)),this.chartWidth=this.props.width-this.margin.left-this.margin.right,this.xScale=p.m().domain(p.e(this.props.data,(function(t){return t.ts}))).range([0,this.chartWidth]).interpolate(p.g),this.drawChart(this.props.height))}},{key:"componentDidMount",value:function(){this.drawChart(this.props.height)}},{key:"render",value:function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{ref:this.node}),this.renderRSILegend(),this.renderStochRSILegend(),this.renderCandleLegend(),this.renderPriceLegend(),this.renderVolumeLegend(),this.renderTooltip())}},{key:"renderChartTitle",value:function(){var t=this.props.metadata;return n.a.createElement("div",{className:"ChartTitle"},n.a.createElement("img",{className:"LegendIcon",src:t.icon,alt:t.name}),n.a.createElement("div",{className:"ItemName"},t.name))}},{key:"renderCandleLegend",value:function(){var t=this.state.currentDate,e=this.props.metadata;null===t&&(t=this.props.data[this.props.data.length-1].ts);var a,r,i,s,c=this.candleData.find((function(e){return e.start<=t&&e.end>=t}));return c?(a=c.high,r=c.low,i=c.open,s=c.close,n.a.createElement("div",{className:"Legend",style:{top:this.margin.top}},n.a.createElement("div",{className:"LegendHeader"},n.a.createElement("img",{className:"LegendIcon",src:"data:image/png;base64,".concat(e.icon),alt:e.name}),n.a.createElement("div",{className:"ItemName"},e.name.replace(/_/g," "))),n.a.createElement("div",{className:"Label"},"Open: ",n.a.createElement("span",{className:"Value"},this.gpFormat(i))),n.a.createElement("div",{className:"Label"},"Close: ",n.a.createElement("span",{className:"Value"},this.gpFormat(s))),n.a.createElement("div",{className:"Label"},"High: ",n.a.createElement("span",{className:"Value"},this.gpFormat(a))),n.a.createElement("div",{className:"Label"},"Low: ",n.a.createElement("span",{className:"Value"},this.gpFormat(r))))):n.a.createElement("div",{className:"Legend",style:{display:"none"}})}},{key:"renderPriceLegend",value:function(){var t=this.state.currentDate;null===t&&(t=this.props.data[this.props.data.length-1].ts);var e,a,r=this.props.data.find((function(e){return e.ts===t}));return r&&(e=r.daily,a=r.average),n.a.createElement("div",{className:"Legend",style:{top:this.candleHeight}},n.a.createElement("div",{className:"Label Blue"},"Daily: ",n.a.createElement("span",{className:"Value"},this.legendFormat(e))),n.a.createElement("div",{className:"Label Orange"},"Average: ",n.a.createElement("span",{className:"Value"},this.legendFormat(a))))}},{key:"renderVolumeLegend",value:function(){var t=this.state.currentDate;null===t&&(t=this.props.data[this.props.data.length-1].ts);var e=this.props.data.find((function(e){return e.ts===t})),a=e?e.volume:null;return n.a.createElement("div",{className:"Legend",style:{top:this.candleHeight+this.priceHeight}},n.a.createElement("div",{className:"Label LightBlue"},"Volume: ",n.a.createElement("span",{className:"Value"},this.legendFormat(a))))}},{key:"renderTooltip",value:function(){var t=this.margin,e=this.props.height,a=this.state,r=a.currentDate,i=a.currentScale;null===r&&(r=this.props.data[this.props.data.length-1].ts);var s={year:"numeric",month:"short",day:"numeric",timeZone:"UTC"};return n.a.createElement("div",{className:"tooltip",style:{left:i(r)-50,top:e-t.bottom-t.xbuffer}},n.a.createElement("span",{style:{position:"center"}},new Date(r).toLocaleDateString("en-US",s)))}},{key:"renderRSILegend",value:function(){var t=this.state.currentDate;null===t&&(t=this.rsiData[this.rsiData.length-1].ts);var e,a=this.rsiData.find((function(e){return e.ts===t}));return a&&(e=a.value),n.a.createElement("div",{className:"Legend",style:{top:this.candleHeight+this.volumeHeight+this.priceHeight}},n.a.createElement("div",{className:"Label Pink"},"RSI: ",n.a.createElement("span",{className:"Value"},this.legendFormat(e))))}},{key:"renderStochRSILegend",value:function(){var t=this.state.currentDate;null===t&&(t=this.rsiData[this.rsiData.length-1].ts);var e,a,r=this.rsiData.find((function(e){return e.ts===t}));return r&&(r.value,r.stoch,a=r.k,e=r.d),a<0&&(a=0),e<0&&(e=0),n.a.createElement("div",{className:"Legend",style:{top:this.candleHeight+this.volumeHeight+this.priceHeight+this.rsiHeight}},n.a.createElement("div",{className:"Label Red"},"STOCH RSI(k): ",n.a.createElement("span",{className:"Value"},this.legendFormat(a))),n.a.createElement("div",{className:"Label Blue"},"STOCH RSI(d): ",n.a.createElement("span",{className:"Value"},this.legendFormat(e))))}},{key:"buildCandlestickChart",value:function(t,e){var a=this.candleHeight-this.margin.top-this.margin.xbuffer;this.candlestickChart=t.append("g").attr("class","candlestick-chart").attr("width",this.chartWidth).attr("height",a).attr("transform","translate(".concat(this.margin.left,", ").concat(this.margin.top,")")),this.candlestickChart.append("defs").append("svg:clipPath").attr("id","candleclip").append("svg:rect").attr("width",this.chartWidth).attr("height",a).attr("x",0).attr("y",0),this.candlestickChart.append("g").attr("id","xAxis").attr("transform","translate(0, ".concat(a,")")),this.candlestickChart.append("g").attr("id","yAxis").attr("transform","translate(".concat(this.chartWidth,", 0)")),this.updateCandlestickChart(e)}},{key:"buildPriceChart",value:function(t,e){var a=this.priceHeight-this.margin.xbuffer;this.priceChart=t.append("g").attr("width",this.chartWidth).attr("height",a).attr("transform","translate(".concat(this.margin.left,", 0)")),this.priceChart.append("defs").append("svg:clipPath").attr("id","priceclip").append("svg:rect").attr("width",this.chartWidth).attr("height",a).attr("x",0).attr("y",0),this.priceChart.append("g").attr("id","xAxis").attr("transform","translate(0, ".concat(a,")")),this.priceChart.append("g").attr("id","yAxis").attr("transform","translate(".concat(this.chartWidth,", 0)")),this.updatePriceChart(e)}},{key:"buildVolumeChart",value:function(t,e){var a=this.volumeHeight-this.margin.xbuffer;this.volumeChart=t.append("g").attr("width",this.chartWidth).attr("height",a).attr("transform","translate(".concat(this.margin.left,", 0)")),this.volumeChart.append("defs").append("svg:clipPath").attr("id","volumeclip").append("svg:rect").attr("width",this.chartWidth).attr("height",a).attr("x",0).attr("y",0),this.volumeChart.append("g").attr("id","xAxis").attr("transform","translate(0, ".concat(a,")")),this.volumeChart.append("g").attr("id","yAxis").attr("transform","translate(".concat(this.chartWidth,", 0)")),this.updateVolumeChart(e)}},{key:"buildRSIChart",value:function(t,e){var a=this.rsiHeight-this.margin.xbuffer;this.rsiChart=t.append("g").attr("width",this.chartWidth).attr("height",a).attr("transform","translate(".concat(this.margin.left,", 0)")),this.rsiChart.append("defs").append("svg:clipPath").attr("id","rsiclip").append("svg:rect").attr("width",this.chartWidth).attr("height",a).attr("x",0).attr("y",0),this.rsiChart.append("g").attr("id","xAxis").attr("transform","translate(0, ".concat(a,")")),this.rsiChart.append("g").attr("id","yAxis").attr("transform","translate(".concat(this.chartWidth,", 0)")),this.updateRSIChart(e)}},{key:"buildStochRSIChart",value:function(t,e){var a=this.stochRsiHeight-this.margin.xbuffer;this.stochRsiChart=t.append("g").attr("width",this.chartWidth).attr("height",a).attr("transform","translate(".concat(this.margin.left,", 0)")),this.stochRsiChart.append("defs").append("svg:clipPath").attr("id","stochrsiclip").append("svg:rect").attr("width",this.chartWidth).attr("height",a).attr("x",0).attr("y",0),this.stochRsiChart.append("g").attr("id","xAxis").attr("transform","translate(0, ".concat(a,")")),this.stochRsiChart.append("g").attr("id","yAxis").attr("transform","translate(".concat(this.chartWidth,", 0)")),this.updateStochRSIChart(e)}},{key:"updateCandlestickChart",value:function(t){var e=this,a=this.candleHeight-this.margin.top-this.margin.xbuffer,r=t.invert(0),n=t.invert(this.chartWidth),i=this.candleData,s=this.candleData.filter((function(t){return t.end>r&&t.start<n})),c=p.j(s,(function(t){return t.low}))-5,l=p.i(s,(function(t){return t.high}))+5,o=p.l().domain([Math.max(0,c),l]).range([a,0]);this.candlestickChart.select("#xAxis").call(p.a(t).tickSize(-a).tickPadding(5).ticks(10)),this.candlestickChart.select("#yAxis").call(p.b(o).tickFormat(this.gpFormat).tickSize(-this.chartWidth).ticks(10)),this.candlestickChart.selectAll(".candlestick").data(i,(function(t){return t.id})).join((function(a){var r=a.append("g").attr("class","candlestick").attr("clip-path","url(#candleclip)");r.append("rect").attr("fill",(function(t){return t.close>=t.open?e.green:e.red})).attr("x",(function(e){return t(e.start)})).attr("y",(function(t){return o(Math.max(t.open,t.close))})).attr("width",(function(e){return t(e.end)-t(e.start)})).attr("height",(function(t){return Math.max(2,Math.abs(o(t.open)-o(t.close)))})),r.append("line").attr("x1",(function(e){return t(e.start)+(t(e.end)-t(e.start))/2})).attr("x2",(function(e){return t(e.start)+(t(e.end)-t(e.start))/2})).attr("y1",(function(t){return o(t.high)})).attr("y2",(function(t){return o(t.low)})).attr("stroke-width",(function(e){return(t(e.end)-t(e.start))/10})).attr("stroke",(function(t){return t.close>=t.open?e.green:e.red}))}),(function(e){e.select("rect").attr("x",(function(e){return t(e.start)})).attr("y",(function(t){return o(Math.max(t.open,t.close))})).attr("width",(function(e){return t(e.end)-t(e.start)})).attr("height",(function(t){return Math.max(2,Math.abs(o(t.open)-o(t.close)))})),e.select("line").attr("x1",(function(e){return t(e.start)+(t(e.end)-t(e.start))/2})).attr("x2",(function(e){return t(e.start)+(t(e.end)-t(e.start))/2})).attr("y1",(function(t){return o(t.high)})).attr("y2",(function(t){return o(t.low)})).attr("stroke-width",(function(e){return(t(e.end)-t(e.start))/10}))}),(function(t){return t.remove()}))}},{key:"updatePriceChart",value:function(t){var e=this,a=this.priceHeight-this.margin.xbuffer,r=t.invert(0-this.margin.left),n=t.invert(this.chartWidth+this.margin.right),i=this.props.data.filter((function(t){return t.ts>r&&t.ts<n})).map((function(t){var a=e.smaData.find((function(e){return e.ts===t.ts}));return t.average=a.avg,t})),s=p.j(i,(function(t){return Math.min(t.daily,t.average)}))-5,c=p.i(i,(function(t){return Math.max(t.daily,t.average)}))+5,l=p.l().domain([Math.max(s,0),c]).range([a,0]);this.priceChart.select("#xAxis").call(p.a(t).tickSize(-a).ticks(10)),this.priceChart.select("#yAxis").call(p.b(l).tickFormat(this.gpFormat).tickSize(-this.chartWidth).ticks(10));var o=p.h().x((function(e){return t(e.ts)})).y((function(t){return l(t.daily)})),h=p.h().x((function(e){return t(e.ts)})).y((function(t){return l(t.average)}));this.priceChart.selectAll(".priceLines").data([i]).join((function(t){var e=t.append("g").attr("class","priceLines").attr("clip-path","url(#priceclip)");e.append("path").attr("id","dailyline").attr("fill","none").attr("stroke","steelblue").attr("stroke-width",3).attr("d",o),e.append("path").attr("id","averageline").attr("fill","none").attr("stroke","goldenrod").attr("stroke-width",3).attr("d",h)}),(function(t){t.select("#dailyline").attr("d",o),t.select("#averageline").attr("d",h)}),(function(t){return t.remove()}))}},{key:"updateRSIChart",value:function(t){var e=this.rsiHeight-this.margin.xbuffer,a=t.invert(0-this.margin.left),r=t.invert(this.chartWidth+this.margin.right),n=this.rsiData.filter((function(t){return t.ts>a&&t.ts<r})),i=(Math.min(p.j(n,(function(t){return t.d})),p.j(n,(function(t){return t.k}))),Math.max(p.i(n,(function(t){return t.d})),p.i(n,(function(t){return t.k}))),p.l().domain([0,100]).range([e,0]));this.rsiChart.select("#xAxis").call(p.a(t).tickSize(-e).tickPadding(5).ticks(10)),this.rsiChart.select("#yAxis").call(p.b(i).tickFormat(this.volFormat).tickSize(-this.chartWidth).ticks(5));var s=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(t.value)})),c=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(70)})),l=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(30)}));this.rsiChart.selectAll(".priceLines").data([n]).join((function(t){var e=t.append("g").attr("class","priceLines").attr("clip-path","url(#priceclip)");e.append("path").attr("id","dailyline").attr("fill","none").attr("stroke","#c677dc").attr("stroke-width",2).attr("d",s),e.append("path").attr("id","averageline").attr("fill","none").attr("stroke","white").attr("stroke-width",2).attr("stroke-dasharray",4).style("opacity",.5).attr("d",c),e.append("path").attr("id","averageline").attr("fill","none").attr("stroke","white").attr("stroke-width",2).attr("stroke-dasharray",4).style("opacity",.5).attr("d",l)}),(function(t){t.select("#dailyline").attr("d",s)}),(function(t){return t.remove()}))}},{key:"updateStochRSIChart",value:function(t){var e=this.stochRsiHeight-this.margin.xbuffer,a=t.invert(0-this.margin.left),r=t.invert(this.chartWidth+this.margin.right),n=this.rsiData.filter((function(t){return t.ts>a&&t.ts<r})),i=(Math.min(p.j(n,(function(t){return t.d})),p.j(n,(function(t){return t.k}))),Math.max(p.i(n,(function(t){return t.d})),p.i(n,(function(t){return t.k}))),p.l().domain([0,100]).range([e,0]));this.stochRsiChart.select("#xAxis").call(p.a(t).tickSize(-e).tickPadding(5).ticks(10)),this.stochRsiChart.select("#yAxis").call(p.b(i).tickFormat(this.volFormat).tickSize(-this.chartWidth).ticks(5));var s=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(t.d)})),c=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(t.k)})),l=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(80)})),o=p.h().x((function(e){return t(e.ts)})).y((function(t){return i(20)}));this.stochRsiChart.selectAll(".priceLines").data([n]).join((function(t){var e=t.append("g").attr("class","priceLines").attr("clip-path","url(#priceclip)");e.append("path").attr("id","dailyline").attr("fill","none").attr("stroke","#46a4f3").attr("stroke-width",2).attr("d",s),e.append("path").attr("id","averageline").attr("fill","none").attr("stroke","#d66061").attr("stroke-width",2).attr("d",c),e.append("path").attr("id","averageline").attr("fill","none").attr("stroke","white").attr("stroke-width",2).attr("stroke-dasharray",4).style("opacity",.5).attr("d",l),e.append("path").attr("id","averageline").attr("fill","none").attr("stroke","white").attr("stroke-width",2).attr("stroke-dasharray",4).style("opacity",.5).attr("d",o)}),(function(t){t.select("#dailyline").attr("d",s),t.select("#averageline").attr("d",c)}),(function(t){return t.remove()}))}},{key:"updateVolumeChart",value:function(t){var e=this.volumeHeight-this.margin.xbuffer,a=t.invert(0-this.margin.left),r=t.invert(this.chartWidth+this.margin.right),n=this.props.data,i=n.filter((function(t){return t.ts>a&&t.ts<r})),s=p.i(i,(function(t){return t.volume})),c=p.l().domain([0,Math.max(5,s)]).range([e,0]);this.volumeChart.select("#xAxis").call(p.a(t).tickSize(-e).ticks(10)),this.volumeChart.select("#yAxis").call(p.b(c).tickFormat(this.volFormat).tickSize(-this.chartWidth).ticks(6));var l=this.chartWidth/(i.length+2);this.volumeChart.selectAll(".volume_bar").data(n,(function(t){return t.ts})).join((function(a){return a.append("g").attr("class","volume_bar").attr("clip-path","url(#volumeclip)").append("rect").attr("fill","#6395a4").attr("x",(function(e){return t(e.ts)-l/2})).attr("y",(function(t){return c(t.volume)})).attr("width",(function(t){return l})).attr("height",(function(t){return e-c(t.volume)}))}),(function(a){return a.select("rect").attr("x",(function(e){return t(e.ts)-l/2})).attr("y",(function(t){return c(t.volume)})).attr("width",(function(t){return l})).attr("height",(function(t){return e-c(t.volume)}))}),(function(t){return t.remove()}))}},{key:"drawChart",value:function(t){var e=this,a=p.n(this.node.current);a.selectAll("*").remove();var r=this.chartWidth,n=this.margin,i=a.append("svg").attr("width","100%").attr("height",t),s=i.append("g").attr("width","100%").attr("height",this.candleHeight),c=i.append("g").attr("width","100%").attr("height",this.priceHeight).attr("transform","translate(0, ".concat(this.candleHeight,")")),l=i.append("g").attr("width","100%").attr("height",this.volumeHeight).attr("transform","translate(0, ".concat(this.candleHeight+this.priceHeight,")")),o=i.append("g").attr("width",this.props.width).attr("height",this.rsiHeight).attr("transform","translate(0, ".concat(this.candleHeight+this.priceHeight+this.volumeHeight,")")),h=i.append("g").attr("width",this.props.width).attr("height",this.stochRsiHeight).attr("transform","translate(0, ".concat(this.candleHeight+this.priceHeight+this.volumeHeight+this.rsiHeight,")"));this.buildCandlestickChart(s,this.state.currentScale),this.buildPriceChart(c,this.state.currentScale),this.buildVolumeChart(l,this.state.currentScale),this.buildRSIChart(o,this.state.currentScale),this.buildStochRSIChart(h,this.state.currentScale);var d=i.append("line").classed("x",!0).style("fill","none").style("pointer-events","none").style("stroke",this.text).style("opacity",.7).style("stroke-width","1.5px"),u=this,m=p.c((function(t){return t.ts})).left,g=this.props.data;function f(){console.log("generateCrosshair");var e=u.state.currentScale,a=p.k(this)[0];if(a<n.left||a>r+n.left)d.style("display","none");else{var i=e.invert(a-n.left),s=m(g,i,1,g.length-1),c=g[s-1],l=g[s],o=i-c.ts>l.ts-i?l.ts:c.ts;u.setState({currentDate:o});var h=n.left+e(o);d.attr("x1",0).attr("x2",0).attr("y1",n.top).attr("y2",t-n.bottom).attr("transform","translate(".concat(h,", 0)"))}}d.on("mousedown",(function(){return console.log("fuck")})).on("mouseup",(function(){return console.log("fuck up")})),a.on("mousemove",f).on("mousedown",(function(){return console.log("fuck")})).on("mouseup",(function(){return console.log("fuck up")})).on("mouseover",(function(){console.log("mouseover"),d.style("display",null),p.o(".tooltip").style("display",null)})).on("mouseout",(function(){console.log("mouseout"),e.setState({currentDate:g[g.length-1].ts}),d.style("display","none"),p.o(".tooltip").style("display","none")}));var v=f.bind(i.node()),y=this.xScale.domain(),k=(y[1].getTime()-y[0].getTime())/53568e5,b=p.p().scaleExtent([1,k]).extent([[this.margin.left,this.margin.top],[this.props.width-this.margin.right,this.candleHeight-this.margin.xbuffer]]).translateExtent([[this.margin.left,-1/0],[this.props.width-this.margin.right,1/0]]).on("start",(function(){d.style("display","none"),p.o(".tooltip").style("display","none")})).on("zoom",this.zoomed).on("end",(function(){v(),d.style("display",null),p.o(".tooltip").style("display",null)}));a.call(b).call(b.transform,this.transform)}},{key:"generateRSI",value:function(t,e){for(var a=[],r=t.map((function(t){return t.daily})),n=0,i=0,s=1;s<e;s++){var c=(r[s]-r[s-1])/r[s-1]*100;n+=c>=0?c:0,i+=c<0?-1*c:0}n/=e,i/=e;for(var l=e;l<t.length;l++){var o=(r[l]-r[l-1])/r[l-1]*100,h=100-100/(1+(n=(13*n+(o>=0?o:0))/14)/(i=(13*i+(o<0?-1*o:0))/14));a.push({value:isNaN(h)?0:h,k:0,d:0,ts:t[l].ts})}var d=m.a.calculate({values:r,rsiPeriod:e,stochasticPeriod:e,kPeriod:3,dPeriod:3}),u=a.length-d.length;for(s=u;s<a.length;s++)a[s].k=d[s-u].k,a[s].d=d[s-u].d;return a}},{key:"generateSimpleMovingAverage",value:function(t,e){var a=[],r=0;return t.forEach((function(n,i){if(i<e)r+=n.daily,a.push({ts:n.ts,avg:r/(i+1)});else{var s=t.slice(i-e,i).reduce((function(t,e){return t+e.daily}),0)/e;a.push({ts:n.ts,avg:s})}})),a}},{key:"generateCandlestickData",value:function(t,e){for(var a=[],r=0;r<t.length-1;r+=e-1){var n=t.slice(r,r+e),i={id:r,high:p.i(n,(function(t){return t.daily})),low:p.j(n,(function(t){return t.daily})),open:n[0].daily,close:n[n.length-1].daily,volume:n.reduce((function(t,e){return t+e.volume})),start:n[0].ts,end:n[n.length-1].ts};a.push(i)}return a}},{key:"zoomed",value:function(){console.log(p.d.type);var t=p.d.transform.rescaleX(this.xScale);this.updateCandlestickChart(t),this.updatePriceChart(t),this.updateVolumeChart(t),this.updateStochRSIChart(t),this.updateRSIChart(t),this.setState({currentScale:t})}}]),e}(r.Component),f=a(31),v=a(144),y=a(145),k=a(149),b=a(148),x=a(146),C=a(147),S=a(56),E=a(143),w=a(152),H=a(151),N=a(39),L=a(41);function I(t){var e=t.data,a=(t.metadata,t.onSelect),r=t.selected,i=t.formatGp,s=t.pgSize,c=t.expanded,l=[{Header:"Name",accessor:"name",Cell:function(t){return n.a.createElement("div",null,n.a.createElement("img",{height:24,style:{marginBottom:"-8px"},src:"data:image/png;base64,".concat(t.row.original.icon),alt:""}),t.row.original.name)}},{Header:"Price",accessor:"daily",sortType:function(t,e,a,r){return t.original.daily>e.original.daily?1:-1},Cell:function(t){var e=t.cell.value;return i(e)}},{Header:"Volume",accessor:"volume",Cell:function(t){return i(t.row.original.volume)}}],o=[{Header:"Buy Limit",accessor:"buy_limit",Cell:function(t){var e=t.cell.value;return i(e)}},{Header:"High Alch. Value",accessor:"high_alch",Cell:function(t){var e=t.cell.value;return i(e)}},{Header:"High Alch. Profit",accessor:"high_alch_profit",sortType:function(t,e,a,r){return t.original.high_alch_profit>e.original.high_alch_profit?1:-1},Cell:function(t){var e=t.cell.value;return i(e)}}],h=n.a.useMemo((function(){return c?l.concat(o):l}),[c,l,o]),d=Object(f.c)({columns:h,data:e,initialState:{pageIndex:0,pageSize:s}},f.b,f.a),u=d.getTableProps,p=d.getTableBodyProps,m=d.headerGroups,g=(d.rows,d.prepareRow),v=d.pageOptions,S=d.page,E=d.state.pageIndex,w=d.previousPage,N=d.nextPage,L=d.canPreviousPage,I=d.canNextPage;return n.a.createElement(n.a.Fragment,null,n.a.createElement(y.a,u(),n.a.createElement(x.a,null,m.map((function(t){return n.a.createElement(C.a,t.getHeaderGroupProps(),t.headers.map((function(t){return n.a.createElement(b.a,t.getHeaderProps(t.getSortByToggleProps()),t.render("Header"),n.a.createElement("span",null,t.isSorted?t.isSortedDesc?" \u2191":" \u2193":""))})))}))),n.a.createElement(k.a,p(),S.map((function(t,e){return g(t),n.a.createElement(C.a,Object.assign({className:t.original.id===r?"PriceTableRow Selected":"PriceTableRow",onClick:function(){a(t.original.id)}},t.getRowProps()),t.cells.map((function(t){return n.a.createElement(b.a,t.getCellProps(),t.render("Cell"))})))})))),n.a.createElement("div",{className:"Footer"},n.a.createElement(H.a,{onClick:function(){return w()},disabled:!L},"Prev"),n.a.createElement("div",null,"Page"," ",n.a.createElement("em",null,E+1," of ",v.length)),n.a.createElement(H.a,{onClick:function(){return N()},disabled:!I},"Next")))}var D=function(t){function e(t){var a;return Object(c.a)(this,e),a=Object(o.a)(this,Object(h.a)(e).call(this,t)),console.log(t.metadata),a.metadata=t.metadata,a.theme=Object(S.a)({palette:{primary:{500:"#d66061"},type:"dark"}}),a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){var t=this,e=this.props.height-56-56-40-40;return n.a.createElement("div",{className:"Sidebar"},n.a.createElement(E.a,{theme:this.theme},n.a.createElement("div",{className:"Header"},n.a.createElement("img",{src:"./coins.png",className:"HeaderImage",alt:""}),n.a.createElement("div",{className:"Logo"},"OSRS Watch")),n.a.createElement("div",{className:"SearchBarContainer"},n.a.createElement(w.a,{type:"text",className:"Searchbar",style:{width:"100%"},placeholder:"Search...",onKeyDown:function(e){13!==e.which||e.shiftKey||t.props.filterSidebar(e)}}),n.a.createElement(H.a,{onClick:this.props.toggleExpand,className:"ExpandButton"},this.props.expanded?n.a.createElement(N.a,{icon:L.b}):n.a.createElement(N.a,{icon:L.a}))),n.a.createElement(v.a,null),n.a.createElement(I,{data:this.props.items,selected:this.props.activeItemId,metadata:this.metadata,onSelect:this.props.onSelect,formatGp:this.props.formatGp,pgSize:Math.round(e/40),expanded:this.props.expanded})))}}]),e}(r.Component),j=function(t){function e(t){var a;return Object(c.a)(this,e),(a=Object(o.a)(this,Object(h.a)(e).call(this,t))).state={loading:!0,items:null,activeItemId:null,expanded:!1,priceData:null,candleData:null,sidebarItems:[],filteredItems:[]},a.chart=n.a.createRef(),a.onResize=a.onResize.bind(Object(d.a)(a)),a.toggleExpand=a.toggleExpand.bind(Object(d.a)(a)),a.filterSidebar=a.filterSidebar.bind(Object(d.a)(a)),a.onSidebarSelect=a.onSidebarSelect.bind(Object(d.a)(a)),a.processMetadata=a.processMetadata.bind(Object(d.a)(a)),a}return Object(u.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){var t=this;window.addEventListener("resize",this.onResize,!1),fetch("/market_watch_api/metadata",{}).then((function(t){return t.json()})).then((function(e){return t.processMetadata(e)})),this.onResize()}},{key:"toggleExpand",value:function(){this.setState((function(t){return{expanded:!t.expanded}}))}},{key:"onResize",value:function(){this.setState({chartWidth:window.innerWidth-400,chartHeight:window.innerHeight-0-0})}},{key:"processMetadata",value:function(t){var e=this,a=[],r={},n=t.find((function(t){return 561==t.item_id}));for(var i in t){var s=t[i];a.push({name:s.name,average:s.price,daily:s.price,volume:s.volume,id:s.item_id,icon:s.icon,buy_limit:s.buy_limit,high_alch:s.high_alch,high_alch_profit:s.high_alch-s.price-n.price,oneDayChange:.5,oneWeekChange:.5,oneMonthChange:.5})}a.sort((function(t,e){return t.name>e.name?1:-1})),fetch("/market_watch_api/prices?id=".concat(a[0].id),{}).then((function(t){return t.json()})).then((function(t){e.setState({loading:!1,items:r,sidebarItems:a,filteredItems:a,activeItemId:a[0].id,priceData:t,candleData:null})}))}},{key:"onSidebarSelect",value:function(t){var e=this;fetch("/market_watch_api/prices?id=".concat(t),{}).then((function(t){return t.json()})).then((function(a){e.setState({activeItemId:t,priceData:a})}))}},{key:"filterSidebar",value:function(t){var e=t.target.value.toLowerCase(),a=this.state.sidebarItems.filter((function(t){return t.name.toLowerCase().includes(e)}));this.setState({filteredItems:a})}},{key:"renderLoadingAnimation",value:function(){return n.a.createElement("div",{className:"LoadingContainer"},n.a.createElement("div",{className:"lds-roller",style:{color:"black"}},n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null),n.a.createElement("div",null)))}},{key:"render",value:function(){if(this.state.loading)return this.renderLoadingAnimation();var t=this.state,e=t.activeItemId,a=t.chartWidth,r=t.chartHeight,i=this.state.sidebarItems.find((function(t){return t.id===e})),s=this.state.priceData.map((function(t){return{ts:new Date(t.ts),daily:+t.price,average:+t.price,volume:+t.volume}})),c=p.f(".3~s"),l=this.state.expanded;return n.a.createElement("div",{className:"Wrapper"},n.a.createElement("div",{className:l?"Container Expanded":"Container"},n.a.createElement(D,{items:this.state.filteredItems,metadata:this.state.sidebarItems,filterSidebar:this.filterSidebar,activeItemId:this.state.activeItemId,onSelect:this.onSidebarSelect,expanded:this.state.expanded,toggleExpand:this.toggleExpand,formatGp:c,height:r}),n.a.createElement("div",{className:l?"Content Expanded":"Content"},n.a.createElement("div",{className:"ChartContainer",ref:this.chart,style:{margin:0,position:"relative"}},n.a.createElement(g,{metadata:i,data:s,width:a,height:r})))))}}]),e}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(n.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},53:function(t,e,a){}},[[106,1,2]]]);
//# sourceMappingURL=main.c612c259.chunk.js.map